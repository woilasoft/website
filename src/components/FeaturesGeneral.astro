---
// Import the necessary dependencies
import { Image } from "astro:assets";
import IconBlock from "@/components/ui/IconBlock.astro";
import Icon from "@/components/ui/icons/Icon.astro";
import type { Lang } from "@/i18n";

interface Feature {
  heading: {
    fr: string;
    en: string;
  };
  content: {
    fr: string;
    en: string;
  };
  svg: string;
}

interface Props {
  title?: string;
  subTitle?: string;
  features?: Feature[];
  src?: any;
  alt?: string;
}

// Define props from Astro
const { title, subTitle, src, alt, features } = Astro.props;

const locale = Astro.currentLocale!;

const localizedFeatures = features?.map((feature) => ({
  heading: feature.heading[locale as "en" | "fr"],
  content: feature.content[locale as "en" | "fr"],
  svg: feature.svg,
}));
---

<section class="w-full px-0 py-10 sm:px-6 lg:px-8 lg:py-10">
  <!-- Block to display the feature image -->
  <div class="relative mb-6 overflow-hidden sm:hidden md:mb-8">
    {
      src && alt && (
        <Image
          src={src}
          alt={alt}
          class="h-full w-full object-cover object-center"
          draggable={"false"}
          loading={"lazy"}
        />
      )
    }
  </div>

  <!-- Displaying the main content consisting of title, subtitle, and several `IconBlock` components -->
  <div class="mt-5 grid gap-8 lg:mt-16 lg:grid-cols-3 lg:gap-12">
    <!-- Block for title and subtitle -->
    <div class="lg:col-span-1">
      <!-- Rendering title -->
      <h2 class="text-balance text-2xl font-bold text-neutral-800 md:text-3xl">
        {title}
      </h2>
      <!-- Rendering subtitle -->
      {
        subTitle && (
          <p class="mt-2 text-pretty text-neutral-600  md:mt-4">
            <Fragment set:html={subTitle} />
          </p>
        )
      }
    </div>

    <!-- Block to display the IconBlock components -->
    <div class="lg:col-span-2">
      <div class="grid gap-8 sm:grid-cols-2 md:gap-12">
        <!-- Injecting IconBlock components with different properties -->
        {
          localizedFeatures &&
            localizedFeatures.map((feature) => (
              <IconBlock heading={feature.heading} content={feature.content}>
                <Icon name={feature.svg} classIcon="-mt-1" />
              </IconBlock>
            ))
        }
      </div>
    </div>
  </div>
</section>
